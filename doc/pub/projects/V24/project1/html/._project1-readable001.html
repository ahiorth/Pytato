<!--
File automatically generated using DocOnce (https://github.com/doconce/doconce/):
doconce format html project1.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project1-readable --html_code_style=inherit
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="E-MOD321 Basic Python coding for subsurface applications">
<title>E-MOD321 Basic Python coding for subsurface applications</title>
<!-- Bootstrap style: bootswatch_readable -->
<!-- doconce format html project1.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project1-readable --html_code_style=inherit -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Exercise 1: Install Bedmap to visualize Antarctica ice data',
               1,
               None,
               'exercise-1-install-bedmap-to-visualize-antarctica-ice-data'),
              ('Background', 2, None, 'background'),
              ('Exercise 2: Read data from file',
               1,
               None,
               'exercise-2-read-data-from-file'),
              ('Pandas (easy):', 2, None, 'pandas-easy'),
              ('`numpy.loadtxt` (medium):', 2, None, 'numpy-loadtxt-medium'),
              ('Vanilla Python (hard):', 2, None, 'vanilla-python-hard'),
              ('Store the data in a dictionary (optional)',
               3,
               None,
               'store-the-data-in-a-dictionary-optional'),
              ('Exercise 3: Matplotlib visualization',
               1,
               None,
               'exercise-3-matplotlib-visualization'),
              ('Convert list to Numpy arrays and plot (easy)',
               3,
               None,
               'convert-list-to-numpy-arrays-and-plot-easy'),
              ('Exercise 4: Use Pandas to visualize oil production data',
               1,
               None,
               'exercise-4-use-pandas-to-visualize-oil-production-data'),
              ('Exercise 5: More wells, more oil?',
               1,
               None,
               'exercise-5-more-wells-more-oil'),
              ('Bibliography', 1, None, 'bibliography')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="project1-readable.html">E-MOD321 Basic Python coding for subsurface applications</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._project1-readable000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="#exercise-1-install-bedmap-to-visualize-antarctica-ice-data" style="font-size: 80%;"><b>Exercise 1: Install Bedmap to visualize Antarctica ice data</b></a></li>
     <!-- navigation toc: --> <li><a href="#background" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Background</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-2-read-data-from-file" style="font-size: 80%;"><b>Exercise 2: Read data from file</b></a></li>
     <!-- navigation toc: --> <li><a href="#pandas-easy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Pandas (easy):</a></li>
     <!-- navigation toc: --> <li><a href="#numpy-loadtxt-medium" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;`numpy.loadtxt` (medium):</a></li>
     <!-- navigation toc: --> <li><a href="#vanilla-python-hard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vanilla Python (hard):</a></li>
     <!-- navigation toc: --> <li><a href="#store-the-data-in-a-dictionary-optional" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Store the data in a dictionary (optional)</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-3-matplotlib-visualization" style="font-size: 80%;"><b>Exercise 3: Matplotlib visualization</b></a></li>
     <!-- navigation toc: --> <li><a href="#convert-list-to-numpy-arrays-and-plot-easy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convert list to Numpy arrays and plot (easy)</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-4-use-pandas-to-visualize-oil-production-data" style="font-size: 80%;"><b>Exercise 4: Use Pandas to visualize oil production data</b></a></li>
     <!-- navigation toc: --> <li><a href="#exercise-5-more-wells-more-oil" style="font-size: 80%;"><b>Exercise 5: More wells, more oil?</b></a></li>
     <!-- navigation toc: --> <li><a href="#bibliography" style="font-size: 80%;"><b>Bibliography</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0001"></a>
<!-- !split -->
<h1 id="exercise-1-install-bedmap-to-visualize-antarctica-ice-data" class="anchor">Exercise 1: Install Bedmap to visualize Antarctica ice data  </h1>
<h2 id="background" class="anchor">Background  </h2>
<p>There is currently a great deal of concern about global warming.
Some critical issues are whether we are more likely to observe
extreme local temperatures, increased frequencies of natural
disasters like forest fires and droughts, and if there are
"tipping points" in the climate system that are, at least on the
human timescale, irreversible <a href="#IPCC2021">[1]</a>.
One particular question to ask is: How much ice is likely to melt?
And, what would be the consequence of ice melting for sea level rise (SLR)?
</p>

<p>Since most of the ice on Planet Earth is located in Antarctica, substantial
effort has been spent in mapping the ice and the bedrock of this continent.
Most of the data is freely available, and we can use Python to investigate
different scenarios. Here we will only show you how to install the packages and visualize the ice thickness. 
</p>

<p>
<b>Part 1.</b>
</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Create a new environment</b>
<p>The ice data are located in the <em>bedmap2</em> dataset <a href="#fretwell2013bedmap2">[2]</a>
The <a href="https://github.com/fatiando/rockhound" target="_self">rockhound</a>
library can be used to load the data. As an aid to plotting, you might also want to use color maps from the
<a href="https://pypi.org/project/cmocean/" target="_self">cmocean</a> package <a href="#thyng2016true">[3]</a>. To install bedmap2 data you have to create a new conda environment (we call it ice)
</p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;">conda config --add channels conda-forge
conda create -n ice python matplotlib numpy \ 
scipy xarray==0.19.0 pandas rockhound cmocean pip jupyter
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that we need a specific version of the <code>xarray</code> library.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;">conda activate project1
jupyter notebook
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</div>


<p>
<b>Part 2.</b>
The code below is taken from the
<a href="https://www.fatiando.org/rockhound/latest/api/generated/rockhound.fetch_bedmap2.html" target="_self">rockound library documentation</a>:
</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">rockhound</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">rh</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">cmocean</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

bedmap <span style="color: #666666">=</span> rh<span style="color: #666666">.</span>fetch_bedmap2(datasets<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;thickness&quot;</span>,<span style="color: #BA2121">&quot;surface&quot;</span>,<span style="color: #BA2121">&quot;bed&quot;</span>])
plt<span style="color: #666666">.</span>figure(figsize<span style="color: #666666">=</span>(<span style="color: #666666">8</span>, <span style="color: #666666">7</span>))
ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">111</span>)
bedmap<span style="color: #666666">.</span>surface<span style="color: #666666">.</span>plot<span style="color: #666666">.</span>pcolormesh(ax<span style="color: #666666">=</span>ax,cmap<span style="color: #666666">=</span>cmocean<span style="color: #666666">.</span>cm<span style="color: #666666">.</span>ice,
                       cbar_kwargs<span style="color: #666666">=</span><span style="color: #008000">dict</span>(pad<span style="color: #666666">=0.01</span>, aspect<span style="color: #666666">=30</span>))
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&quot;Bedmap2 Antarctica&quot;</span>)
plt<span style="color: #666666">.</span>tight_layout()
plt<span style="color: #666666">.</span>show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> Run the code and reproduce figure <a href="#fig:bedmap2_ice_thickness">1</a>.</li>
</ul>
<center> <!-- figure label: --> <div id="fig:bedmap2_ice_thickness"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 1: Visualization of the ice thickness in Antarctica.  <!-- caption label: fig:bedmap2_ice_thickness --></p>
</center>
<p><img src="fig-project1/bedmap2_plot.png" width="800" align="bottom"></p>
</center>

<ul>
<li> Check out <a href="https://www.fatiando.org/rockhound/latest/gallery/index.html" target="_self">the gallery</a>. Choose one of the datasets, copy and paste the code and reproduce one of the figures in the gallery.</li> 
</ul>
<h1 id="exercise-2-read-data-from-file" class="anchor">Exercise 2: Read data from file </h1>
<p>As part of this project we will look at some of the datasets that
are available at the Norwegian Offshore Directorate
<a href="https://factpages.sodir.no/" target="_self">website</a>.
</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Data directory</b>
<p>In the following we will assume that you have a <code>src</code> directory containing all your Python code and a <code>data</code> folder inside your course folder. Thus, if you are in your <code>src</code> folder you can access files in the <code>data</code> folder by moving one folder up an down inside your <code>data</code> folder.</p>
</div>

<h2 id="pandas-easy" class="anchor">Pandas (easy): </h2>
<p>Pandas will most likely be your first choice, because it has so much built in functionalities</p>

<ul>
<li> Run the following code and explain why the first <code>pd.read_csv</code> fails or does not produce the output we want</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;../data/draugen.txt&#39;</span>)
<span style="color: #008000">print</span>(df)
df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;../data/draugen.txt&#39;</span>,sep<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>)
<span style="color: #008000">print</span>(df)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> Print only the year column from <code>df</code> i) using the label <code>Year</code> and ii) <code>df.columns[0]</code></li>
<li> Print the column with oil equivalents</li>
</ul>
<h2 id="numpy-loadtxt-medium" class="anchor"><code>numpy.loadtxt</code> (medium): </h2>

<p><code>Numpy.loadtxt</code> is a build in function in Numpy that reads tabulated data, it does not know what to do with a header line, and we need to tell it how many lines to skip</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
data<span style="color: #666666">=</span>np<span style="color: #666666">.</span>loadtxt(<span style="color: #BA2121">&#39;../data/draugen.txt&#39;</span>,skiprows<span style="color: #666666">=1</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> How can you print out only the year, month, etc. columns from the <code>data</code> variable?</li>
<li> Use <code>data=np.loadtxt('../data/draugen.txt',skiprows=1,unpack=True)</code>, what changes now?</li> 
</ul>
<h2 id="vanilla-python-hard" class="anchor">Vanilla Python (hard): </h2>

<p>When accessing files, it can be easy to forget to <em>close</em> the file after opening it. This can lead to problems as an open file, in many cases, cannot be accessed by other programs. To avoid this we use the <code>with</code> statement. The following code can be used to print out all the lines of a file, and Python will open and close the file for you</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(<span style="color: #BA2121">&quot;../data/draugen.txt&quot;</span>) <span style="color: #008000; font-weight: bold">as</span> my_file:
     <span style="color: #008000; font-weight: bold">for</span> line <span style="color: #AA22FF; font-weight: bold">in</span> my_file:
     	 <span style="color: #008000">print</span>(line)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>After the code is run, the variable <code>line</code> will still hold the last line of the file, which should be <code>'2023\t10\t0.072419\t0.019985\t0\t0.092404\t1.005672\n'</code>. The first two numbers are year (2023) and the month (10), for the rest check the header in the file. The <code>\t</code> means tabular and <code>\n</code> means a newline. In order to parse this line we need to pick out the numbers, the easiest way in Python is to split the line on <code>\t</code>, if you do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">data_list<span style="color: #666666">=</span>line<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>)
<span style="color: #008000">print</span>(data_list)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>we conveniently get all the elements separated by <code>\t</code> into a list (of strings). To convert a string to a number we can do e.g. <code>float(data_list[0])</code>.</p>

<ul>
<li> Modify the following code to extract year, month, and oil equivalents. Remember we need to skip the first header line, which contains only text.</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">year<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># empty list</span>
month<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># empty list</span>
oe<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># empty list</span>
read_first_line<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>
<span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(<span style="color: #BA2121">&quot;../data/draugen.txt&quot;</span>) <span style="color: #008000; font-weight: bold">as</span> my_file:
     <span style="color: #008000; font-weight: bold">for</span> line <span style="color: #AA22FF; font-weight: bold">in</span> my_file:
     	 <span style="color: #008000; font-weight: bold">if</span> read_first_line:
	    data_list<span style="color: #666666">=</span>line<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>)
	    year<span style="color: #666666">.</span>append(<span style="color: #008000">float</span>(data_list[<span style="color: #666666">0</span>]))
	    <span style="color: #3D7B7B; font-style: italic">#same for month</span>
	    <span style="color: #3D7B7B; font-style: italic">#same for oil equivalents</span>
	 read_first_line<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>
	 
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="store-the-data-in-a-dictionary-optional" class="anchor">Store the data in a dictionary (optional) </h3>
<p>Tabulated data with a header is perfect for a dictionary, here we create a dictionary based on the header in the file.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">data_dict<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;year&#39;</span>:[], <span style="color: #BA2121">&#39;month&#39;</span>:[],<span style="color: #BA2121">&#39;oil&#39;</span>:[],<span style="color: #BA2121">&#39;gas&#39;</span>:[],<span style="color: #BA2121">&#39;cond&#39;</span>:[],<span style="color: #BA2121">&#39;oe&#39;</span>:[],<span style="color: #BA2121">&#39;wat&#39;</span>:[]}
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> modify the code above to store all data in each line in the dictionary. To loop over all entries in the <code>data_dict</code>, and the list elements in <code>data_list</code>, you can use the <code>zip</code> function</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">for</span> key,data <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">zip</span>(data_dict,data_list):
    data_dict[key]<span style="color: #666666">.</span>append(<span style="color: #008000">float</span>(data))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-3-matplotlib-visualization" class="anchor">Exercise 3: Matplotlib visualization  </h1>
<p>To access the data a bit easier I have added a file <code>draugen_pandas.py</code> in the <code>data</code> folder containing our data as lists. We can access them by importing them directly into our script. However, as we are in the <code>src</code> folder it causes a practical problem to access a Python file in a different folder and the only way to do this is to add the <code>data</code> folder to our path</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
sys<span style="color: #666666">.</span>path<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;../data/&#39;</span>)
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">draugen_data</span> <span style="color: #008000; font-weight: bold">import</span> year,month,oil,gas,wat,cond,oe
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> Use matplotlib to plot oil equivalents, <code>oe</code>, vs the <code>year</code> data, compare with the <a href="https://factpages.sodir.no/en/field/PageView/All/43758" target="_self">official data</a>.</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>

plt<span style="color: #666666">.</span>plot(<span style="color: #3D7B7B; font-style: italic">#fill inn code)</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Our plot looks a bit strange, because we do not take into account the month column. We need to create a new list e.g. <code>year_month=year+month/12</code>.</p>
<h3 id="convert-list-to-numpy-arrays-and-plot-easy" class="anchor">Convert list to Numpy arrays and plot (easy) </h3>

<p><code>year_month=year+month/12</code> will not work for lists as Python does not understand what <code>month/12</code> is, and even if it did the <code>+</code> operation would not give the expected results. But, if we convert our list to a Numpy array, life becomes easy.</p>

<ul>
<li> Use <code>year_month=np.array(year)+np.array(month)/12</code> and create a new plot, with <code>year_month</code> on the x-axis.</li>
<li> Try to make the plot as similar as possible to figure <a href="#fig:p1:ose">2</a></li> 
</ul>
<center> <!-- figure label: --> <div id="fig:p1:ose"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 2: <!-- caption label: fig:p1:ose --></p>
</center>
<p><img src="fig-project1/oseberg.png" width="800" align="bottom"></p>
</center>

<h1 id="exercise-4-use-pandas-to-visualize-oil-production-data" class="anchor">Exercise 4: Use Pandas to visualize oil production data </h1>

<p>When analyzing data it is very advantageous to start by making a plot.
The human mind is usually good at detecting patterns, and by looking at
the data one can test out ideas, before possibly
doing a more comprehensive analysis.
</p>

<p>As part of this project we will look at some of the datasets that
are available at the Norwegian Petroleum Directorate (NPD)
<a href="http://factpages.npd.no/factpages/" target="_self">website</a>.
</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Do not Repeat Yourself (DRY)</b>
<p>Use functions to divide a problem into smaller pieces. Functions should not do too much, that increases the probability that they can be reused. </p>
</div>


<p>
<b>Part 1.</b>
</p>

<ul>
<li> Write a function that has the signature as indicated below, and returns a DataFrame containing data for all fields. It should return an empty DataFrame along with an error message if something went wrong.</li>
</ul>
<p>Note: you can join strings by simply doing <code>folder+datafile</code> </p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">df_all_data</span>(datafile<span style="color: #666666">=</span><span style="color: #BA2121">&#39;field_production_gross_monthly.xls&#39;</span>,folder<span style="color: #666666">=</span><span style="color: #BA2121">&#39;../data/&#39;</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    datafile: name (and path) to data file</span>
<span style="color: #BA2121; font-style: italic">    returns DataFrame </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<div class="alert alert-block alert-success alert-text-normal"><b>Notice</b>
<p>All data files needed for this project are located in the <code>data</code> folder.</p>
</div>


<ul>
<li> Write a function that take as argument the name of a field and returns a DataFrame with data from that specific field.</li>
<li> The function should return an error message if the name cannot be found. As a help to the user one could also print out possible (unique) names that exists in the data file for the specific column.</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df_fields<span style="color: #666666">=</span>df_all_data()
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">df_field</span>(name,df_fields, col<span style="color: #666666">=0</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of field</span>
<span style="color: #BA2121; font-style: italic">    df_fields: DataFrame with all field data </span>
<span style="color: #BA2121; font-style: italic">    col: which column to test against to find field data</span>
<span style="color: #BA2121; font-style: italic">    returns DataFrame </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ul>
<li> To check your code, open the file <code>field_production_gross_monthly.xls</code>, and compare its contents with output from the command <code>print(df_field('OSEBERG'))</code>.</li>
</ul>
<p>
<b>Part 2.</b>
</p>

<p>Next, we wish to look at the historical oil production versus time for a
specific field. Such plots are already available at the
<a href="http://factpages.npd.no/factpages/" target="_self">NPD website</a>, but here you are going to
make your own by using the <a href="https://matplotlib.org" target="_self"><tt>matplotlib</tt></a> library, and <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html" target="_self">Pandas</a>. 
</p>

<ul>
<li> Start by extracting oil production data for a specific field with the function already defined in Part 1:</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot_prod_data</span>(name,df_fields,fluid<span style="color: #666666">=</span><span style="color: #BA2121">&#39;oil&#39;</span>, pandas<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>):

    df <span style="color: #666666">=</span> df_field(name,df_fields) <span style="color: #3D7B7B; font-style: italic"># get DataFrame</span>
    <span style="color: #3D7B7B; font-style: italic"># extract production data, and plot using matplotlib or the build in pandas</span>
    <span style="color: #3D7B7B; font-style: italic"># functions</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<div class="alert alert-block alert-success alert-text-normal"><b>Speed</b>
<p>It will be much faster <em>not</em> to read the Excel file each time, read it once and pass the DataFrame to the function.</p>
</div>


<ul>
<li> Finish implementation of the code above, if <code>pandas=True</code> it should make a plot using the Pandas library, and if <code>pandas=False</code> it should make a plot using the Matplotlib library.</li>
</ul>
<p>Calling <code>plot_prod_data('OSEBERG')</code> should generate a figure that looks
something like this:
</p>

<center>  <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 3</p>
</center>
<p><img src="fig-project1/oseberg.png" width="800" align="bottom"></p>
</center>

<p>
<b>Part 3.</b>
In the oil production plot for a given field, we additionally want to include
information about the number of wells that have been drilled. Specifically,
we wish to plot, on a separate \( y \)-axis, the cumulative number of wells present
in the field at any given moment in time.
</p>

<p>Well data is stored in the file <code>wellbore_development_all.xlsx</code>.
In this file, each row entry corresponds to a single well, and the
field to which it belongs is stored in the column with index 14.
Hence, we can start by writing:
</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df_wells<span style="color: #666666">=</span>df_all_data(datafile<span style="color: #666666">=</span>`wellbore_development_all<span style="color: #666666">.</span>xlsx`)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot_prod_and_well_data</span>(name,df_fields,df_wells):
    df_w <span style="color: #666666">=</span> df_field(name, df_wells, col<span style="color: #666666">=14</span>)
    year <span style="color: #666666">=</span> df[<span style="color: #BA2121">&#39;Completed year&#39;</span>]  
    <span style="color: #666666">...</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<ul>
<li> Note 1: you can choose to use Pandas <em>or</em> Matplotlib, pick the one that you find most practical.</li>
<li> Note 2: the Excel file only tells you the year in which each well was completed; <em>there could be many wells drilled in a given year, and the list is not sorted</em>. This means that you need to a little more work to process the data</li>
<li> Finish implementing the above Python function.</li>
<li> Calling it with a specific field as input should generate a plot that looks something like this:</li>
</ul>
<center>  <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 4</p>
</center>
<p><img src="fig-project1/oseberg_wells.png" width="800" align="bottom"></p>
</center>

<p>If you want, you can also distinguish between different types of wells, i.e.,
between injection/production/observation wells.
</p>
<h1 id="exercise-5-more-wells-more-oil" class="anchor">Exercise 5: More wells, more oil? </h1>

<p>A very common statement is "more wells - more oil". The fields on the Norwegian
Continental Shelf (NCS) are in different stages of production, and they have
varying reservoir properties, so a thorough analysis would take time.
However, we would at least expect to see some correlation between the
<em>total amount of oil produced</em> and <em>the number of wells drilled</em>, if the
hypothesis is correct.
</p>

<p>
<b>Part 1 (OPTIONAL).</b>
So far we have plotted production or well data against time. To investigate relationships, we can also plot cumulative production vs cumulative number wells. We now have two time series i) production vs time and wells vs time, they have different lengths and to plot e.g. production vs wells, you have to have <em>two time series at the same time</em>. This can easily be achieved in Python by using <a href="https://numpy.org/doc/stable/reference/generated/numpy.interp.html" target="_self"><tt>numpy.interp</tt></a>.   
</p>

<p>Hint: the cumulative sum for a vector can be found using <a href="https://numpy.org/doc/stable/reference/generated/numpy.cumsum.html" target="_self"><tt>numpy.cumsum</tt></a></p>

<ul>
<li> plot the cumulative production on the \( y \)-axis and cumulative number of wells on the \( x \)-axis. A successful plot would look something like:</li> 
</ul>
<center>  <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 5</p>
</center>
<p><img src="fig-project1/oseberg_cum.png" width="800" align="bottom"></p>
</center>

<p>
<b>Part 2.</b>
The first task is to fetch the (final) number of wells drilled for each field,
as well as the total (cumulative) oil production. 
</p>

<ul>
<li> Create a Pandas DataFrame, one column with the field names, second column the total volumes produced, and the third column the total number of wells drilled for each field (if you like you can distinguish between producers, injectors and observation wells). Hence, there will only be <em>one entry for each field</em>.</li> 
</ul>
<p>
<b>Part 3.</b>
</p>

<ul>
<li> Make a scatter plot showing the cumulative oil production of all the fields on the \( y \)-axis. On the \( x \)-axis, plot the number of wells for the fields (you might want to exclude observation wells).</li>
</ul>
<p>
<b>Part 4.</b>
The Draugen field is very homogeneous, and it is therefore regarded as an ideal
field on the NCS. It also has an active aquifer underlying the reservoir,
meaning that when producing oil by water injection the aquifer provides
additional pressure support.
</p>

<ul>
<li> Does the plot you made in Part 3 indicate that Draugen has been a successful field compared to the others? Why/why not?</li>
</ul>
<p>(OPTIONAL)</p>
<ul>
<li> To help guide the eye you can also add a regression line, which you can do as follows (assuming data you want to fit a line to are stored in <code>x</code> and <code>y</code> arrays)</li>
</ul>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scipy</span> <span style="color: #008000; font-weight: bold">import</span> stats
slope, intercept, r_value, p_value, std_err<span style="color: #666666">=</span> stats<span style="color: #666666">.</span>linregress(x,y)
trendline <span style="color: #666666">=</span> slope<span style="color: #666666">*</span>np<span style="color: #666666">.</span>array(x)<span style="color: #666666">+</span>intercept
plt<span style="color: #666666">.</span>plot(x,trendline, label<span style="color: #666666">=</span><span style="color: #008000">str</span>(<span style="color: #BA2121">&quot;R value=&quot;</span>)<span style="color: #666666">+</span><span style="color: #008000">str</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">{:.3f}</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>format(r_value)))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="bibliography" class="anchor">Bibliography </h1>

<!-- begin bibliography -->
<ol>
 <li> <div id="IPCC2021"></div> <b>V. Masson-Delmotte, P. Zhai, A. Pirani, S. L. Connors, C. Pean, S. Berger, N. Caud, Y. Chen, L. Goldfarb, M. I. Gomis, M. Huang, K. Leitzell, E. Lonnoy, J. B. R. Matthews, T. K. Maycock, T. Waterfield, O. Yelekci, R. Yu and B. Z. (eds.)</b>.  Climate Change 2021: the Physical Science Basis. Contribution of Working Group I to the Sixth Assessment Report of the Intergovernmental Panel on Climate Change, <em>Cambridge University Press. In Press.</em>, 2021.</li>
 <li> <div id="fretwell2013bedmap2"></div> <b>P. Fretwell, H. D. Pritchard, D. G. Vaughan, J. L. Bamber, N. E. Barrand, R. Bell, C. Bianchi, R. Bingham, D. D. Blankenship and G. Casassa</b>.  Bedmap2: Improved Ice Bed, Surface and Thickness Datasets for Antarctica, <em>The Cryosphere</em>, 7(1), pp. 375-393, 2013.</li>
 <li> <div id="thyng2016true"></div> <b>K. M. Thyng, C. A. Greene, R. D. Hetland, H. M. Zimmerle and S. F. DiMarco</b>.  True Colors of Oceanography: Guidelines for Effective and Accurate Colormap Selection, <em>Oceanography</em>, 29(3), pp. 9-13, 2016.</li>
</ol>
<!-- end bibliography -->
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._project1-readable000.html">&larr; Prev</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>

