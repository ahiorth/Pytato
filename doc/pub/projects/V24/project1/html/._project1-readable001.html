<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html project1.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project1-readable --html_code_style=inherit
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="E-MOD321 Project in Basic Python coding for subsurface applications">
<title>E-MOD321 Project in Basic Python coding for subsurface applications</title>
<!-- Bootstrap style: bootswatch_readable -->
<!-- doconce format html project1.do.txt LANG=C.UTF-8 --html_style=bootswatch_readable --html_output=project1-readable --html_code_style=inherit -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Exercise 1: Matplotlib visualization',
               1,
               None,
               'exercise-1-matplotlib-visualization'),
              ('Exercise 2: Loop over data',
               1,
               None,
               'exercise-2-loop-over-data'),
              ('Exercise 3: Boolean masking',
               1,
               None,
               'exercise-3-boolean-masking'),
              ('Exercise 4: Dictionaries and Pandas DataFrame',
               1,
               None,
               'exercise-4-dictionaries-and-pandas-dataframe'),
              ('Exercise 5: Extract data using a function',
               1,
               None,
               'exercise-5-extract-data-using-a-function'),
              ('Exercise 6: Create a function for plotting data',
               1,
               None,
               'exercise-6-create-a-function-for-plotting-data'),
              ('Exercise 7: Write data to files',
               1,
               None,
               'exercise-7-write-data-to-files'),
              ('Exercise 8: Loop over all fields',
               1,
               None,
               'exercise-8-loop-over-all-fields'),
              ('Exercise 9: lambda functions',
               1,
               None,
               'exercise-9-lambda-functions'),
              ('Exercise 10: Assert your code',
               1,
               None,
               'exercise-10-assert-your-code'),
              ('Exercise 11: A simple class',
               1,
               None,
               'exercise-11-a-simple-class'),
              ('Exercise 12: A more comprehensive class',
               1,
               None,
               'exercise-12-a-more-comprehensive-class'),
              ('(OPTIONAL) Exercise 13: The Dash library',
               1,
               None,
               'optional-exercise-13-the-dash-library')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="project1-readable.html">E-MOD321 Project in Basic Python coding for subsurface applications</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._project1-readable000.html#table_of_contents" style="font-size: 80%;">Table of contents</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-1-matplotlib-visualization" style="font-size: 80%;">Exercise 1: Matplotlib visualization</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-2-loop-over-data" style="font-size: 80%;">Exercise 2: Loop over data</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-3-boolean-masking" style="font-size: 80%;">Exercise 3: Boolean masking</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-4-dictionaries-and-pandas-dataframe" style="font-size: 80%;">Exercise 4: Dictionaries and Pandas DataFrame</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-5-extract-data-using-a-function" style="font-size: 80%;">Exercise 5: Extract data using a function</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-6-create-a-function-for-plotting-data" style="font-size: 80%;">Exercise 6: Create a function for plotting data</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-7-write-data-to-files" style="font-size: 80%;">Exercise 7: Write data to files</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-8-loop-over-all-fields" style="font-size: 80%;">Exercise 8: Loop over all fields</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-9-lambda-functions" style="font-size: 80%;">Exercise 9: lambda functions</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-10-assert-your-code" style="font-size: 80%;">Exercise 10: Assert your code</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-11-a-simple-class" style="font-size: 80%;">Exercise 11: A simple class</a></li>
     <!-- navigation toc: --> <li><a href="#exercise-12-a-more-comprehensive-class" style="font-size: 80%;">Exercise 12: A more comprehensive class</a></li>
     <!-- navigation toc: --> <li><a href="#optional-exercise-13-the-dash-library" style="font-size: 80%;">(OPTIONAL) Exercise 13: The Dash library</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0001"></a>
<!-- !split -->
<h1 id="exercise-1-matplotlib-visualization" class="anchor">Exercise 1: Matplotlib visualization  </h1>
<p>In <code>jotun_data.py</code> in the <code>data</code> folder "official production data":" <a href="https://factpages.sodir.no/en/field/PageView/All/43604" target="_self"><tt>https://factpages.sodir.no/en/field/PageView/All/43604</tt></a>" are available as lists. You can import them as </p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
sys<span style="color: #666666">.</span>path<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;../data/&#39;</span>)<span style="color: #3D7B7B; font-style: italic"># alternatively put jotun_data.py in your folder</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">jotun_data</span> <span style="color: #008000; font-weight: bold">import</span> years, months, oil_gross, gas_gross, oe_gross, wat_prod
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question:</b>
</p>
<ul>
<li> Use matplotlib to plot oil equivalents, <code>oe_gross</code> vs the <code>years</code> data. Try to make the plot as similar as possible to figure <a href="#p1:jotun">1</a>.</li>
</ul>
<center> <!-- figure label: --> <div id="p1:jotun"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 1:  Jotun production data.  <!-- caption label: p1:jotun --> </p>
</center>
<p><img src="fig-project1/jotun.png" align="bottom" width=800></p>
</center>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-2-loop-over-data" class="anchor">Exercise 2: Loop over data  </h1>
<p>Oil equivalents are simply the sum of oil volumes and gas volumes. (Or to be more specific: The convention used when comparing gas volumes with oil volumes is to divide the gas volumes by 1000, see <a href="https://www.sodir.no/en/about-us/use-of-content/conversion-table/" target="_self">conversion factors</a>. However, we do not need to do anything here because the unit of the gas volumes in <code>jotun_data.py</code> is \( 10^9 \) Sm$^3$ and the oil volumes in \( 10^6 \) Sm$^3$.)</p>

<p>Thus, to calculate oil equivalents from our lists that contain oil and gas volumes you just have to add them together.</p>

<p>
<b>Question 1:</b>
Use vanilla Python to loop over <code>oil_gross</code> and <code>gas_gross</code>, create a new <em>list</em>, which holds your calculated oil equivalents volumes. Note: You can compare with <code>oe_gross</code> to check if your calculations are correct.</p>

<p>
<b>Question 2:</b>
Convert your lists to <code>numpy.arrays</code>, by doing e.g. <code>np.array(oil_gross)</code>. Perform the same calculation as in Question 1, but this time using Numpy (and no loop).</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-3-boolean-masking" class="anchor">Exercise 3: Boolean masking  </h1>

<p>
<b>Question 1:</b>
Use vanilla Python to create a loop and sum up all oil equivalents that was produced for the year 2000. (If you did everything correct you should get 7.529206 10$^6$Sm$^3$ for the year 2000.)</p>

<p>
<b>Question 2:</b>
Create to new <code>numpy.arrays</code>, by
</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">years_np<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array(years)
oe_np<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array(oe_gross)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Show how you can use Boolean masking to pick out only produced oil equivalents for the year 2000, without using a loop. Use <code>np.sum()</code> to sum all the volumes. </p>

<p>
<b>Question 3:</b>
Use <code>np.unique()</code> to create a unique <code>np.array()</code> of years. Loop over this array and use Boolean masking to create a new list (or <code>np.array()</code>) that holds the total produced oil equivalents for that year.</p>

<p>
<b>Question 4:</b>
Use the results in the previous question to create a bar plot and compare with figure <a href="#p1:jotun2">2</a></p>

<center> <!-- figure label: --> <div id="p1:jotun2"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 2:  Jotun production data.  <!-- caption label: p1:jotun2 --> </p>
</center>
<p><img src="fig-project1/jotun_oe.png" align="bottom" width=800></p>
</center>

<h1 id="exercise-4-dictionaries-and-pandas-dataframe" class="anchor">Exercise 4: Dictionaries and Pandas DataFrame </h1>

<p>
<b>Question 1:</b>
Create a dictionary that holds all the Jotun data (i.e. <code>years, months, oil_gross, gas_gross, oe_gross, wat_prod</code>) you imported in Exercise 1. Choose suitable key names to use in the dictionary.</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">data_dict<span style="color: #666666">=</span>{<span style="color: #3D7B7B; font-style: italic"># fill inn}</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question 2:</b>
Create a loop over all the keys in <code>data_dict</code> and show how you can print out the keys and the values in the dictionary.</p>

<p>
<b>Question 3:</b>
Create a DataFrame from your dictionary. Show how we can use <code>DataFrame.groupby().sum()</code> to find production of oil, gas, water, and oil equivalents per year. </p>
<h1 id="exercise-5-extract-data-using-a-function" class="anchor">Exercise 5: Extract data using a function  </h1>

<p>
<b>Question:</b>
Create a function from the following code. The function should take as argument the field name and return a DataFrame with field data. Include a docstring in the function.</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df_prod<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/field_production_gross_monthly.xlsx&#39;</span>)
df<span style="color: #666666">=</span>df_prod[df_prod[<span style="color: #BA2121">&#39;Field (Discovery)&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;JOTUN&#39;</span>]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_data</span>(field):
    <span style="color: #3D7B7B; font-style: italic"># write code here ..</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #3D7B7B; font-style: italic">#...</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Optional:</b>
Make the function more robust, by allowing for case insensitive names and/or give a warning if no data was extracted for the field.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-6-create-a-function-for-plotting-data" class="anchor">Exercise 6: Create a function for plotting data  </h1>

<p>
<b>Question 1:</b>
Create a function that takes as argument the name of a field, and plots oil equivalent production vs time. (Hint: you should use the function you wrote in the previous exercise to extract the data.)</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot_field</span>(field):
    <span style="color: #3D7B7B; font-style: italic"># create plot ...</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question 2:</b>
Extend the function such that if no data is extracted from the field, write a warning and do not make the plot. (Note: you can use <code>DataFrame.empty()</code> to check if the DataFrame contains data.) </p>

<p>
<b>Optional:</b>
Extend the function such that it can take in a list of values (e.g. gas, oil, etc.) that should be plotted in the same plot.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-7-write-data-to-files" class="anchor">Exercise 7: Write data to files  </h1>

<p>
<b>Question 1:</b>
Explain what the following code does. By adding comment lines to each line of the following code.</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">field<span style="color: #666666">=</span><span style="color: #BA2121">&#39;JOTUN&#39;</span> <span style="color: #3D7B7B; font-style: italic"># com1</span>
<span style="color: #3D7B7B; font-style: italic">#--------- start --------</span>
df<span style="color: #666666">=</span>get_data(field) <span style="color: #3D7B7B; font-style: italic"># com2</span>
data_folder<span style="color: #666666">=</span>pt<span style="color: #666666">.</span>Path(<span style="color: #BA2121">&#39;tmp_data&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># com3 </span>
data_folder<span style="color: #666666">.</span>mkdir(exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)<span style="color: #3D7B7B; font-style: italic"># etc.</span>
new_name<span style="color: #666666">=</span><span style="color: #008000">str</span><span style="color: #666666">.</span>replace(field,<span style="color: #BA2121">&#39;/&#39;</span>,<span style="color: #BA2121">&#39;&#39;</span>)
new_path<span style="color: #666666">=</span>data_folder <span style="color: #666666">/</span> new_name
new_path<span style="color: #666666">.</span>mkdir(exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
df2<span style="color: #666666">=</span>df[df[df<span style="color: #666666">.</span>columns[<span style="color: #666666">0</span>]]<span style="color: #666666">==</span>field]
df2<span style="color: #666666">.</span>to_excel(new_path<span style="color: #666666">/</span><span style="color: #BA2121">&#39;production_data.xlsx&#39;</span>,index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
<span style="color: #3D7B7B; font-style: italic">#-------- stop ----------</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question 2:</b>
Create a function from the code between <code>-- start --</code> and <code>-- stop --</code>. It should take as argument the field name.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">write_data</span>(field):
    <span style="color: #3D7B7B; font-style: italic"># ....</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #3D7B7B; font-style: italic">#optional </span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question 3:</b>
If your Excel file is open in another program, the command <code>df2.to_excel(new_path/'production_data.xlsx',index=False)</code>, will fail. Use the <code>try:</code> and <code>except:</code> commands to try and write the Excel file, and if this fails, give the user a warning.</p>

<p>
<b>Optional:</b>
Extend the previous function and introduce a default argument, representing <code>tmp_data</code> so that the user can specify the directory name.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-8-loop-over-all-fields" class="anchor">Exercise 8: Loop over all fields  </h1>
<p>The following code writes all field data to separate Excel files.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/field_production_gross_monthly.xlsx&#39;</span>)
fields<span style="color: #666666">=</span>df[df<span style="color: #666666">.</span>columns[<span style="color: #666666">0</span>]]<span style="color: #666666">.</span>unique() <span style="color: #3D7B7B; font-style: italic">#skip duplicates</span>
data_folder<span style="color: #666666">=</span>pt<span style="color: #666666">.</span>Path(<span style="color: #BA2121">&#39;tmp_data&#39;</span>)
data_folder<span style="color: #666666">.</span>mkdir(exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
<span style="color: #008000; font-weight: bold">for</span> field <span style="color: #AA22FF; font-weight: bold">in</span> fields:
    new_name<span style="color: #666666">=</span><span style="color: #008000">str</span><span style="color: #666666">.</span>replace(field,<span style="color: #BA2121">&#39;/&#39;</span>,<span style="color: #BA2121">&#39;&#39;</span>)
    new_path<span style="color: #666666">=</span>data_folder <span style="color: #666666">/</span> new_name
    new_path<span style="color: #666666">.</span>mkdir(exist_ok<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    df2<span style="color: #666666">=</span>df[df[df<span style="color: #666666">.</span>columns[<span style="color: #666666">0</span>]]<span style="color: #666666">==</span>field]
    df2<span style="color: #666666">.</span>to_excel(new_path<span style="color: #666666">/</span><span style="color: #BA2121">&#39;production_data.xlsx&#39;</span>,index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question:</b>
Use one or several functions to achieve the same as the block of code above does. Comment on your choice.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-9-lambda-functions" class="anchor">Exercise 9: lambda functions  </h1>
<p>Rewrite the following functions, using Pythons <code>lambda</code> function</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">remove_space</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">.</span>strip()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">upper_case</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">.</span>upper()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-10-assert-your-code" class="anchor">Exercise 10: Assert your code  </h1>
<p>Create two assert tests for <code>remove_space</code> and <code>upper_case</code> defined in the previous exercise.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#answer</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="exercise-11-a-simple-class" class="anchor">Exercise 11: A simple class  </h1>

<p>
<b>Question1:</b>
Take a look at the following class, and explain what each line does, by adding comments behind each line.</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">DeclineCurve</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>,q,tau):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>q<span style="color: #666666">=</span>q 
        <span style="color: #008000">self</span><span style="color: #666666">.</span>tau<span style="color: #666666">=</span>tau
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(<span style="color: #008000">self</span>,t):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>q<span style="color: #666666">*</span>np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>t<span style="color: #666666">/</span><span style="color: #008000">self</span><span style="color: #666666">.</span>tau)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question2:</b>
Add a function to the class, named <code>plot()</code>, such that the following code produce the output in figure <a href="#fig:p1:dec">3</a>. (To create a suitable list of <code>t</code> values you can do <code>t=np.linspace(0,10,1000)</code>, or more general <code>t=np.linspace(0,10*self.tau,1000)</code>)</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">A<span style="color: #666666">=</span>DeclineCurve(<span style="color: #666666">1</span>,<span style="color: #666666">1</span>)
A<span style="color: #666666">.</span>plot()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<center> <!-- figure label: --> <div id="fig:p1:dec"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 3:  An exponential decline curve.  <!-- caption label: fig:p1:dec --> </p>
</center>
<p><img src="fig-project1/decline.png" align="bottom" width=800></p>
</center>

<h1 id="exercise-12-a-more-comprehensive-class" class="anchor">Exercise 12: A more comprehensive class  </h1>
<p>Inspect the following class</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ProdData</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    A class to extract production data from FactPages</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>df_prod<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/field_production_gross_monthly.xlsx&#39;</span>)
    
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_data</span>(<span style="color: #008000">self</span>,field):
<span style="color: #bbbbbb">        </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">        Extracts data for a specific field</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;</span>
        df<span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>df_prod[(<span style="color: #008000">self</span><span style="color: #666666">.</span>df_prod[<span style="color: #BA2121">&#39;Field (Discovery)&#39;</span>] <span style="color: #666666">==</span> field)]
        <span style="color: #008000; font-weight: bold">return</span> df   
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Add the following functions to the class:</p>
<ol>
<li> <code>write_data(field)</code> write data for a single field to an Excel file</li>
<li> <code>write_all_data()</code> write an Excel file for each field</li>
<li> A function to plot production data for a field</li>
</ol>
<p>
<b>The following is optional:</b>
</p>
<ol>
<li> Add some checking to the functions, this could be a sensible error message if e.g. the file <code>../data/field_production_gross_monthly.xlsx</code> does not exists or that it is not possible to write data to file.</li>
<li> Add some unit tests using assert, this could be to check that the oil produced for a certain year (and month) for a specific field is equal to a specific value.</li>
</ol>
<h1 id="optional-exercise-13-the-dash-library" class="anchor">(OPTIONAL) Exercise 13: The Dash library  </h1>
<p><a href="https://dash.plotly.com/" target="_self">The Dash library</a> is one of the most popular libraries. Install it by doing</p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">conda install dash
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>(If this fails, run <code>pip install dash</code>). Run the following code, which is copied from <a href="https://dash.plotly.com/minimal-app" target="_self">a minimal dash app</a>.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dash</span> <span style="color: #008000; font-weight: bold">import</span> Dash, html, dcc, callback, Output, Input
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">plotly.express</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">px</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>

df <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;https://raw.githubusercontent.com/plotly/datasets/master/gapminder_unfiltered.csv&#39;</span>)

app <span style="color: #666666">=</span> Dash(<span style="color: #19177C">__name__</span>)

app<span style="color: #666666">.</span>layout <span style="color: #666666">=</span> html<span style="color: #666666">.</span>Div([
    html<span style="color: #666666">.</span>H1(children<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Title of Dash App&#39;</span>, style<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;textAlign&#39;</span>:<span style="color: #BA2121">&#39;center&#39;</span>}),
    dcc<span style="color: #666666">.</span>Dropdown(df<span style="color: #666666">.</span>country<span style="color: #666666">.</span>unique(), <span style="color: #BA2121">&#39;Canada&#39;</span>, <span style="color: #008000">id</span><span style="color: #666666">=</span><span style="color: #BA2121">&#39;dropdown-selection&#39;</span>),
    dcc<span style="color: #666666">.</span>Graph(<span style="color: #008000">id</span><span style="color: #666666">=</span><span style="color: #BA2121">&#39;graph-content&#39;</span>)
])

<span style="color: #AA22FF">@callback</span>(
    Output(<span style="color: #BA2121">&#39;graph-content&#39;</span>, <span style="color: #BA2121">&#39;figure&#39;</span>),
    Input(<span style="color: #BA2121">&#39;dropdown-selection&#39;</span>, <span style="color: #BA2121">&#39;value&#39;</span>)
)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">update_graph</span>(value):
    dff <span style="color: #666666">=</span> df[df<span style="color: #666666">.</span>country<span style="color: #666666">==</span>value]
    <span style="color: #008000; font-weight: bold">return</span> px<span style="color: #666666">.</span>line(dff, x<span style="color: #666666">=</span><span style="color: #BA2121">&#39;year&#39;</span>, y<span style="color: #666666">=</span><span style="color: #BA2121">&#39;pop&#39;</span>)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">__name__</span> <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    app<span style="color: #666666">.</span>run(debug<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Question:</b>
Can you modify the code above to read and plot our data in <code>../data/field_production_gross_monthly.xlsx</code>? (Note: you can also download the production data directly by copying the correct address, by right-clicking on the Excel (or csv) tab <a href="https://factpages.sodir.no/en/field/TableView/Production/SumWellbores/Monthly" target="_self">here</a>.) </p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">

  <li class="previous">
    <a href="._project1-readable000.html">&larr; Prev</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>
    

